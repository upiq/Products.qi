<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="context/general/macros/master"
      i18n:domain="Products.qi">
<head>
</head>

<body>
<div metal:fill-slot="main"
    tal:define="name string:name;
                measure string:measure;
                start string:start;
                end string:end;
                goal string:goal;
                topicid string:topicid;
                topic view/topic;
                baseErrors python:view.getError('base')">
    
    <h2 tal:content="topic/name">TOPIC NAME</h2>
    
    <table class="listing" tal:condition="python:len(view.measures())>0">
        <tr>
            <th>Measure name</th>
            <th>Measure short name</th>
            <th>Active</th>
            <th>Start Date</th>
            <th>End Date</th>
            <th>Goal</th>
        </tr>
        <tal:measures define="rows view/measures">
            <tr tal:repeat="measure rows">
                <td tal:content="measure/measure/name">name</td>
                <td tal:content="measure/measure/shortname">short name</td>
                <td tal:content="measure/active">active</td>
                <td tal:content="python:view.reformatdate(measure.startdate)">start date</td>
                <td tal:content="python:view.reformatdate(measure.enddate)">end date</td>
                <td tal:content="measure/goal">goal</td>
            </tr>
        </tal:measures>
        
    </table>
    
    <div tal:condition="baseErrors" class="error">
        <h3>The addition failed see reasons below</h3>
    </div>
    
    <tal:generalErrors condition="baseErrors" repeat="err baseErrors">
        <div class="error" tal:content="err">
            General error
        </div>
    </tal:generalErrors>
    



<form
    action='.'
    tal:attributes="action view/url"
  	method="post"
  	id="upload_data"
  	enctype="multipart/form-data">

	<fieldset id="upload">

        <input type="hidden" name="topicid"
            tal:attributes="value python:view.topic().id" />
        <div class="field"
 			tal:define="localname measure;
 			            errors python:view.getError(localname);
   			            localvalue python:request.get(localname, -1)"
 			tal:attributes="class python:errors and 'field error' or 'field'">


 			<label i18n:translate="label_uploadtype_name"
   				tal:attributes="for localname">Measure</label>

            <div><tal:errors repeat="error errors">
                <div tal:content="error">Validation error output</div>
            </tal:errors></div>

			<select
   				tal:attributes="name localname;
   								id localname;
   								"
   	        >
   	            <option value="-1">-------</option>
   	            <tal:choices repeat="choice view/availableMeasures">
   	                <option 
   	                    tal:attributes="value choice/id;
   	                                    selected python:int(choice.id)==int(localvalue)" 
   	                    tal:content="choice/name">
   	                    </option>
   	            </tal:choices>
   	        </select>
			Can't find the right measure? <a href="Add_Measure.html">Add a Measure.</a>
            
        </div>
        
        <div class="field"
 			tal:define="localname start;
 			            errors python:view.getError(localname);
   			            localvalue python:request.get(localname, '')"
 			tal:attributes="class python:errors and 'field error' or 'field'">


 			<label i18n:translate="label_uploadtype_name"
   				tal:attributes="for localname">Start Date</label>
				<p class="description">
   	                Specify in MM/DD/YYYY format when this measure
   	                becomes applicable to this topic.
   				</p>

            <div><tal:errors repeat="error errors">
                <div tal:content="error">Validation error output</div>
            </tal:errors></div>

			<input type="text"
   				tal:attributes="name localname;
   								id localname;
   								value localvalue"
   	        />
        </div>
        <div class="field"
 			tal:define="localname end;
 			            errors python:view.getError(localname);
   			            localvalue python:request.get(localname, '')"
 			tal:attributes="class python:errors and 'field error' or 'field'">


 			<label i18n:translate="label_uploadtype_name"
   				tal:attributes="for localname">End Date</label>
   				<p class="description">
   	                Specify in MM/DD/YYYY format when this measure is 
   	                no longer applicable within this topic.
   				</p>

            <div><tal:errors repeat="error errors">
                <div tal:content="error">Validation error output</div>
            </tal:errors></div>

			<input type="text"
   				tal:attributes="name localname;
   								id localname;
   								value localvalue"
   	        />
        </div>
        <div class="field"
 			tal:define="localname goal;
 			            errors python:view.getError(localname);
   			            localvalue python:request.get(localname, '')"
 			tal:attributes="class python:errors and 'field error' or 'field'">


 			<label i18n:translate="label_uploadtype_name"
   				tal:attributes="for localname">Goal</label>
   				<p class="description">
   	                This is the target value for this measure within the bounds 
   	                of this topic.  For example, percent of patients receiving a 
					test may be 80%.
   				</p>

            <div><tal:errors repeat="error errors">
                <div tal:content="error">Validation error output</div>
            </tal:errors></div>

			<input type="text"
   				tal:attributes="name localname;
   								id localname;
   								value localvalue"
   	        />
        </div>

		<div class="formControls">

			<input class="context"
   				type="submit"
   				name="add"
   				value="Add"
   				/>
   	    </div>

	</fieldset>

</form>

</div>
</body>
</html>
