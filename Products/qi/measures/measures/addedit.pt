<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="context/general/macros/master"
      i18n:domain="Products.qi">
<head metal:fill-slot="javascript_head_slot">
	<script type="text/javascript">
	//<![CDATA[
		function showlist()
		{
			thetrs = document.getElementById("measureTable").getElementsByTagName("tr");

			for (var i=0; i<thetrs.length;i++){
					thetrs[i].style.display = '';
			}
		}
		function hidelist()
		{
			thetrs = document.getElementById("measureTable").getElementsByTagName("tr");

			for (var i=0; i<thetrs.length;i++){
					thetrs[i].style.display = 'none';
			}
		}
    //]]>
	</script>
</head>

<body>
<div metal:fill-slot="main"
    tal:define="name string:name;
                shortname string:shortname;
                definition string:definition;
                guidance string:guidance;
                source string:source;
                type string:type;
                validation string:validation;
                goal string:goal;
                userdefined string:userdefined;
                version string:version;
                measuretype string:measuretype;
                measureid string:measureid;
                baseErrors python:view.getError('base')">

<h3>Existing Measures</h3>
<fieldset>
	<legend>
		<a href="javascript:showlist()">Show</a>
		<a href="javascript:hidelist()">Hide</a>
	</legend>
	<table class="listing" id ="measureTable">
		<tr style='display:none'>
	        <th>Short name</th>
	        <th>Measure</th>
	        <!--
	        <th>Definition</th>-->
	        <th>Guidance</th>
	        <!--<th>Source</th>-->
	        <!--<th>Type</th>-->
	        <th>Validation</th>
	        <th>Goal</th>
	        <!--<th>Version</th>-->
	        <th>Measure Type</th>
			<th>edit</th>
		</tr>
		
	    <tal:existingmeasures repeat="measure view/getExistingMeasures">
	        <tr tal:define="oddrow repeat/measure/odd"
	         tal:attributes="class python:oddrow and 'odd' or 'even'" style='display:none' >
	            <td tal:content="measure/shortname"></td>
	            <td tal:content="measure/name"></td>
	            <!--<td tal:content="measure/definition"></td>-->
	            <td tal:content="measure/guidance"></td>
	            <!--<td tal:content="measure/source"></td>
	            <td tal:content="measure/ttype"></td>-->
	            <td tal:content="measure/validation"></td>
	            <td tal:content="measure/goal"></td>
	            <!--<td tal:content="measure/versionnumber"></td>-->
	            <td tal:content="measure/measuretype"></td>
				<td><a tal:attributes="href python:view.url()+'?measureid=%i'%measure.id">Edit</a></td>
	        </tr>
	    </tal:existingmeasures>
	</table>
</fieldset>

<h3>Create a new measure or edit an existing measure</h3>
    <div tal:condition="view/hasErrors" class="error">
        <h3>The addition failed. See reasons below.</h3>
        <ul>
        <tal:generalErrors condition="baseErrors" repeat="err baseErrors">
            <li class="error" tal:content="err">
                General error
            </li>
        </tal:generalErrors>
        </ul>
    </div>
    



<form
    action='.'
    tal:attributes="action view/url"
  	method="post"
  	id="upload_data"
  	enctype="multipart/form-data">

	<fieldset id="upload">
		<tal:warning condition="python:request.get('measureid',None)">
		    <div class="warning">
		        Warning: Be cautious in editing this measure if it may be in use by another project.
		        Modifying the shortname, validation, or measure type can interfere with data processing
		        for other projects.  If you are unsure about a measure, please contact the QI Teamspace
		        help desk.
	        </div>
	    </tal:warning>
		<tal:hidden
 			define="localname measureid;
 			            errors python:view.getError(localname);
 			            localvalue python:request.get(localname, '-1')"
 			            >


			<input type="hidden"
   				tal:attributes="name localname;
   								id localname;
   								value localvalue"
   	        />
        </tal:hidden>
		
		<div class="field"
 			tal:define="localname name;
 			            errors python:view.getError(localname);
 			            localvalue python:request.get(localname, '')"
 			tal:attributes="class python:errors and 'field error' or 'field'">

 			<label i18n:translate="label_uploadtype_name"
   				tal:attributes="for localname">Name
   				<span class="fieldRequired">(fieldRequired)</span>
   				</label>

            <div><tal:errors repeat="error errors">
                <div tal:content="error">Validation error output</div>
            </tal:errors></div>

			<input type="text"
   				tal:attributes="name localname;
   								id localname;
   								value localvalue"
   	        />
        </div>
        
        
        <div class="field"
 			tal:define="localname shortname;
 			            errors python:view.getError(localname);
   			            localvalue python:request.get(localname, '')"
 			tal:attributes="class python:errors and 'field error' or 'field'">


 			<label i18n:translate="label_uploadtype_name"
   				tal:attributes="for localname">Short name
   	            <span class="fieldRequired">(fieldRequired)</span>
   				</label>

            <div><tal:errors repeat="error errors">
                <div tal:content="error">Validation error output</div>
            </tal:errors></div>

			<input type="text"
   				tal:attributes="name localname;
   								id localname;
   								value localvalue"
   	        />
        </div>

        <div class="field"
 			tal:define="localname definition;
 			            errors python:view.getError(localname);
 			            localvalue python:request.get(localname, '')"
 			tal:attributes="class python:errors and 'field error' or 'field'">


 			<label i18n:translate="label_uploadtype_name"
   				tal:attributes="for localname">Definition</label>

            <div><tal:errors repeat="error errors">
                <div tal:content="error">Validation error output</div>
            </tal:errors></div>

			<textarea
   				tal:attributes="name localname;
   								id localname;"
   				tal:content="localvalue"
   			></textarea>
        </div>
		
        <div class="field"
 			tal:define="localname guidance;
 			            errors python:view.getError(localname);
 			            localvalue python:request.get(localname, '')"
 			tal:attributes="class python:errors and 'field error' or 'field'">


 			<label i18n:translate="label_uploadtype_name"
   				tal:attributes="for localname">Guidance</label>

            <div><tal:errors repeat="error errors">
                <div tal:content="error">Validation error output</div>
            </tal:errors></div>

			<textarea
   				tal:attributes="name localname;
   								id localname;"
   				tal:content="localvalue"
   			></textarea>
        </div>
        
        <div class="field"
 			tal:define="localname source;
 			            errors python:view.getError(localname);
 			            localvalue python:request.get(localname, '')"
 			tal:attributes="class python:errors and 'field error' or 'field'">


 			<label i18n:translate="label_uploadtype_name"
   				tal:attributes="for localname">Source</label>

            <div><tal:errors repeat="error errors">
                <div tal:content="error">Validation error output</div>
            </tal:errors></div>

			<textarea
   				tal:attributes="name localname;
   								id localname;"
   				tal:content="localvalue"
   			></textarea>
        </div>
        
        <div class="field"
 			tal:define="localname type;
 			            errors python:view.getError(localname);
 			            localvalue python:request.get(localname, '')"
 			tal:attributes="class python:errors and 'field error' or 'field'">


 			<label i18n:translate="label_uploadtype_name"
   				tal:attributes="for localname">Type</label>

            <div><tal:errors repeat="error errors">
                <div tal:content="error">Validation error output</div>
            </tal:errors></div>

			<input type="text"
   				tal:attributes="name localname;
   								id localname;
   								value localvalue;"
   			/>
        </div>
		
        <div class="field"
 			tal:define="localname validation;
 			            errors python:view.getError(localname);
 			            localvalue python:request.get(localname, '')"
 			tal:attributes="class python:errors and 'field error' or 'field'">


 			<label i18n:translate="label_uploadtype_name"
   				tal:attributes="for localname">Validation
   				<!--
					<a href="." tal:attributes="href view/validationSuportUrl"
   	                class="small">?</a>
				-->
			</label>
			<p class="description">
				This specifies rules to apply against all data imported for this measure.
			</p>
				
            <div><tal:errors repeat="error errors">
                <div tal:content="error">Validation error output</div>
            </tal:errors></div>

			<textarea
   				tal:attributes="name localname;
   								id localname;"
   				tal:content="localvalue"
   			></textarea>
        </div>
		
        <div class="field"
 			tal:define="localname goal;
 			            errors python:view.getError(localname);
 			            localvalue python:request.get(localname, '')"
 			tal:attributes="class python:errors and 'field error' or 'field'">


 			<label i18n:translate="label_uploadtype_name"
   				tal:attributes="for localname">Goal</label>

            <div><tal:errors repeat="error errors">
                <div tal:content="error">Validation error output</div>
            </tal:errors></div>

			<input type="text"
   				tal:attributes="name localname;
   								id localname;
   								value localvalue;"
   			/>
        </div>
		
        <div class="field"
 			tal:define="localname userdefined;
 			            errors python:view.getError(localname);
 			            localvalue python:request.get(localname, '')"
 			tal:attributes="class python:errors and 'field error' or 'field'">


 			<label i18n:translate="label_uploadtype_name"
   				tal:attributes="for localname">User Defined:</label>

            <div><tal:errors repeat="error errors">
                <div tal:content="error">Validation error output</div>
            </tal:errors></div>

			<textarea
   				tal:attributes="name localname;
   								id localname;"
   				tal:content="localvalue"
   			></textarea>
        </div>
		
        <div class="field"
 			tal:define="localname version;
 			            errors python:view.getError(localname);
 			            localvalue python:request.get(localname, '')"
 			tal:attributes="class python:errors and 'field error' or 'field'">


 			<label i18n:translate="label_uploadtype_name"
   				tal:attributes="for localname">Version</label>

            <div><tal:errors repeat="error errors">
                <div tal:content="error">Validation error output</div>
            </tal:errors></div>

			<input type="text"
   				tal:attributes="name localname;
   								id localname;
   								value localvalue;"
   			/>
        </div>
		
        <div class="field"
 			tal:define="localname measuretype;
 			            errors python:view.getError(localname);
 			            localvalue python:request.get(localname, -1)"
 			tal:attributes="class python:errors and 'field error' or 'field'">


 			<label i18n:translate="label_uploadtype_name"
   				tal:attributes="for localname">Measure Type
                <span class="fieldRequired">(fieldRequired)</span>   				
   	            </label>

				<p class="description">
					Select the type of information that is stored for this measure.  
					If the type of this measure is not present on this list,
					you may add it under the Menu: Shared Resources-&gt;Manage Measure Types.
				</p>
            <div><tal:errors repeat="error errors">
                <div tal:content="error">Validation error output</div>
            </tal:errors></div>

			<select
   				tal:attributes="name localname;
   								id localname;
   								"
   	        >
   	            <option value="-1">-------</option>
   	            <tal:choices repeat="choice view/getMeasureTypes">
   	                <option 
   	                    tal:attributes="value choice/id;
   	                                    selected python:int(choice.id)==int(localvalue)" 
   	                    tal:content="choice">
   	                    </option>
   	            </tal:choices>
   	        </select>
        </div>
        
                
		<div class="formControls">

			<input class="context"
   				type="submit"
   				name="add"
   				value="Save"
   				/>
		</div>

	</fieldset>

</form>

</div>
</body>
</html>
